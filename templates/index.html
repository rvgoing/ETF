<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ˆ å®šæœŸå®šé¡æŠ•è³‡æ¨¡æ“¬å™¨</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .sidebar {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        .main-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .metric-card {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #0d6efd;
        }
        .metric-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #212529;
        }
        .allocation-item {
            font-size: 0.9rem;
            color: #6c757d;
            margin: 5px 0;
        }
        h1 {
            color: #0d6efd;
            margin-bottom: 30px;
        }
        .section-header {
            font-size: 1.1rem;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 15px;
            color: #495057;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3">
                <div class="sidebar">
                    <h1 class="h4">ğŸ“ˆ æŠ•è³‡æ¨¡æ“¬å™¨</h1>
                    
                    <form method="POST" id="investmentForm">
                        <!-- æŠ•è³‡é‡‘é¡è¨­å®š -->
                        <div class="section-header">ğŸ’° æŠ•è³‡é‡‘é¡è¨­å®š</div>
                        <div class="mb-3">
                            <label class="form-label">æ¯æœˆç¸½æŠ•å…¥é‡‘é¡ï¼ˆå…ƒï¼‰</label>
                            <input type="number" class="form-control" name="total_monthly" 
                                   value="{{ values.total_monthly }}" min="0" max="1000000" step="500">
                        </div>
                        
                        <!-- é¡¯ç¤ºåˆ†é…æ˜ç´° -->
                        {% if results %}
                        <div class="allocation-item">ğŸ”¹ 2330 å°ç©é›» (50%)ï¼šNT$ {{ "{:,}".format(results.p_2330) }}</div>
                        <div class="allocation-item">ğŸ”¹ 0050 å°ç£50 (30%)ï¼šNT$ {{ "{:,}".format(results.p_0050) }}</div>
                        <div class="allocation-item">ğŸ”¹ 00770 åŒ—ç¾ç§‘æŠ€ (20%)ï¼šNT$ {{ "{:,}".format(results.p_00770) }}</div>
                        {% endif %}
                        
                        <hr>
                        
                        <!-- æŠ•è³‡åƒæ•¸è¨­å®š -->
                        <div class="section-header">âš™ï¸ æŠ•è³‡åƒæ•¸è¨­å®š</div>
                        <div class="mb-3">
                            <label class="form-label">æŠ•è³‡æœŸé–“ï¼ˆå¹´ï¼‰: {{ values.years }}</label>
                            <input type="range" class="form-range" name="years" 
                                   value="{{ values.years }}" min="1" max="20" 
                                   oninput="this.previousElementSibling.textContent='æŠ•è³‡æœŸé–“ï¼ˆå¹´ï¼‰: '+this.value">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">2330 å ±é…¬ç‡ (%): {{ values.r_2330 }}</label>
                            <input type="range" class="form-range" name="r_2330" 
                                   value="{{ values.r_2330 }}" min="0" max="20" step="0.5"
                                   oninput="this.previousElementSibling.textContent='2330 å ±é…¬ç‡ (%): '+this.value">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">0050 å ±é…¬ç‡ (%): {{ values.r_0050 }}</label>
                            <input type="range" class="form-range" name="r_0050" 
                                   value="{{ values.r_0050 }}" min="0" max="20" step="0.5"
                                   oninput="this.previousElementSibling.textContent='0050 å ±é…¬ç‡ (%): '+this.value">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">00770 å ±é…¬ç‡ (%): {{ values.r_00770 }}</label>
                            <input type="range" class="form-range" name="r_00770" 
                                   value="{{ values.r_00770 }}" min="0" max="20" step="0.5"
                                   oninput="this.previousElementSibling.textContent='00770 å ±é…¬ç‡ (%): '+this.value">
                        </div>
                        
                        <hr>
                        
                        <!-- åœ–è¡¨è¨­å®š -->
                        <div class="section-header">ğŸ¨ åœ–è¡¨è¨­å®š</div>
                        <div class="mb-3">
                            <label class="form-label">åœ–è¡¨é«˜åº¦: {{ values.plot_height }}</label>
                            <input type="range" class="form-range" name="plot_height" 
                                   value="{{ values.plot_height }}" min="4" max="12"
                                   oninput="this.previousElementSibling.textContent='åœ–è¡¨é«˜åº¦: '+this.value">
                        </div>
                        
                        <button type="submit" class="btn btn-primary w-100 mt-3">ğŸš€ è¨ˆç®—æŠ•è³‡çµæœ</button>
                    </form>
                    
                    {% if results %}
                    <hr>
                    <!-- æŠ•è³‡çµæœ -->
                    <div class="section-header">ğŸ“Š æŠ•è³‡çµæœ</div>
                    <div class="metric-card">
                        <div class="metric-label">æ¯æœˆç¸½æŠ•å…¥</div>
                        <div class="metric-value">NT$ {{ "{:,}".format(results.monthly_total) }}</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">ç¸½æŠ•å…¥é‡‘é¡</div>
                        <div class="metric-value">NT$ {{ "{:,}".format(results.total_invested|int) }}</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">{{ values.years }} å¹´å¾Œç¸½è³‡ç”¢</div>
                        <div class="metric-value text-primary">NT$ {{ "{:,}".format(results.total_asset|int) }}</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">é ä¼°ç¸½ç²åˆ©</div>
                        <div class="metric-value text-success">
                            NT$ {{ "{:,}".format(results.total_profit|int) }}
                            <small class="text-muted">({{ "%.1f"|format(results.profit_rate) }}%)</small>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9">
                <div class="main-content">
                    {% if results %}
                    <img src="data:image/png;base64,{{ results.plot_url }}" class="img-fluid" alt="æŠ•è³‡æˆé•·æ›²ç·š">
                    
                    <div class="mt-4">
                        <details>
                            <summary class="btn btn-outline-secondary">ğŸ“Š æŸ¥çœ‹å„æ¨™çš„æœ€çµ‚è³‡ç”¢æ˜ç´°</summary>
                            <div class="mt-3">
                                <p><strong>2330 å°ç©é›»</strong>ï¼šNT$ {{ "{:,}".format(results.fv_2330_final|int) }}</p>
                                <p><strong>0050 å…ƒå¤§å°ç£50</strong>ï¼šNT$ {{ "{:,}".format(results.fv_0050_final|int) }}</p>
                                <p><strong>00770 åœ‹æ³°åŒ—ç¾ç§‘æŠ€</strong>ï¼šNT$ {{ "{:,}".format(results.fv_00770_final|int) }}</p>
                            </div>
                        </details>
                    </div>
                    {% else %}
                    <div class="text-center py-5">
                        <h2>æ­¡è¿ä½¿ç”¨å®šæœŸå®šé¡æŠ•è³‡æ¨¡æ“¬å™¨</h2>
                        <p class="text-muted">è«‹åœ¨å·¦å´è¨­å®šæŠ•è³‡åƒæ•¸ï¼Œç„¶å¾Œé»æ“Šã€Œè¨ˆç®—æŠ•è³‡çµæœã€</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>